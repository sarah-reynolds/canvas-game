<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
<p id="score"></p>
<script type="text/javascript">
	// create the canvas tag with js. the canvas just holds the game
	var canvas = document.createElement('canvas');
	// create a context gor JS to play with (methods, properties, etc)
	var context = canvas.getContext('2d')

	canvas.width = 512; //size of the background
	canvas.height = 480;
	// add the canvas tag to the dom
	document.body.appendChild(canvas);

	var backgroundImage = new Image();//anytime you see something with 'new' (it's a constructr) then it's special and either you or js made it
	backgroundImage.src = "background.png";

	var speedModifier = 1;
	var monsterSpeed = .93;
	// make a variable var for our hero. he is an image
	var hero = new Image();
	hero.src = "hp.png";
	var heroLocation = {
		x: 100,
		y: 100
	}

	// make a var for our bad guy
	var monster = new Image();
	monster.src = "snitch.png";
	var monsterLocation = {
		x: 200,
		y: 100,
		newX: 200,
		newY: 100
	}
	var userScore = 0;
	document.getElementById('score').innerHTML = "Your score: " + userScore
	// an array to hold all the keys that are currently pressed down
	var keysDown = [];

	addEventListener('keyup', function(event){
		delete keysDown[event.keyCode];
	});

	// We need a way to tell if the user has pushed the arrow key
	//anonymous function has no name, and is only called if its parents calls it (which here is the keydown event) -- and with it comes an event parameter
	addEventListener('keydown', function(event){
		// if keyDown[39] is true then the user pushed right
		// if keyDown[40] is true then the user pushed down
		// if keyDown[37] is true then the user pushed left
		// if keyDown[38] is true then the user pushed up

		keysDown[event.keyCode] = true;
		console.log(keysDown);
		// we know a key was pressed or we wouldnt be in here
		// what key did they press?
		// console.log(event.key);
		// if(event.key === 'ArrowDown'){
		// 	console.log('user pressed down arrow')
		// 	heroLocation.y += 10
		// }
		// if(event.key === 'ArrowUp'){
		// 	console.log('user pressed up arrow')
		// 	heroLocation.y -= 10
		// }
		// if(event.key === 'ArrowLeft'){
		// 	console.log('user pressed left arrow')
		// 	heroLocation.x -= 10
		// }
		// if(event.key === 'ArrowRight'){
		// 	console.log('user pressed right arrow')
		// 	heroLocation.x += 10
		// }
	})

// this is where we will update the hero based on whats true in keys down
	function update(){
		// user pressed right at some point because it's in the array
		// add if so that it only runs if the location has not reached the end
		if(39 in keysDown){
			if(heroLocation.x <= 450){
				heroLocation.x += (10 * speedModifier);
			}
		}

		if(37 in keysDown){
			if(heroLocation.x >= 25){
				heroLocation.x -= (10 * speedModifier);
			}
		}

		if(38 in keysDown){
			if(heroLocation.y >= 25){
				heroLocation.y -= (10 * speedModifier);
			}
		}

		if(40 in keysDown){
			if(heroLocation.y <= 410){
				heroLocation.y += (10 * speedModifier);
			}
		}

		// have monster move randomly on the page
		// monsterLocation.x = monsterLocation.x += (1)

		//Andy's version
		// var checkDirection = Math.floor(Math.random() * 4);
		// 	if(checkDirection == 0){
		// 		if(monsterLocation.x <= 450){
		// 			monsterLocation.x += (10 * speedModifier);
		// 		}
		// 	}
		// 	if(checkDirection == 1){
		// 		if(monsterLocation.x >= 25){
		// 			monsterLocation.x += (10 * speedModifier);
		// 		}
		// 	}
		// 	if(checkDirection == 2){
		// 		if(monsterLocation.y <= 410){
		// 			monsterLocation.y += (10 * speedModifier);
		// 		}
		// 	}
		// 	if(checkDirection == 3){
		// 		if(monsterLocation.y >= 25){
		// 			monsterLocation.y += (10 * speedModifier);
		// 		}
		// 	}

		// move monster if you touch him
		if(
			(heroLocation.x <= monsterLocation.x + 32)
			&& (heroLocation.y <= monsterLocation.y + 32)
			&& (monsterLocation.x <= heroLocation.x + 32)
			&& (monsterLocation.y <= heroLocation.y + 32)
			){
				userScore++;
			// randomize the location of the monster upon contact
				var random = Math.random() * 450;
				var random2 = Math.random() * 400;
				monsterLocation.x = random;
				monsterLocation.y = random2;
			}
	}

	function monsterMove(){
		if(
			(monsterLocation.x <= monsterLocation.newX + 32)
			&& (monsterLocation.y <= monsterLocation.newY + 32)
			&& (monsterLocation.newX <= monsterLocation.x + 32)
			&& (monsterLocation.newY <= monsterLocation.y + 32)
			){
			monsterLocation.newX = Math.ceil(Math.random() * 400)
			monsterLocation.newY = Math.ceil(Math.random() * 400)
		}else{
			if(monsterLocation.newX > monsterLocation.x){
				monsterLocation.x += (1 * monsterSpeed)
			}
			if(monsterLocation.newX < monsterLocation.x){
				monsterLocation.x -= (1 * monsterSpeed)
			}
			if(monsterLocation.newY > monsterLocation.y){
				monsterLocation.y += (1 * monsterSpeed)
			}
			if(monsterLocation.newY < monsterLocation.y){
				monsterLocation.y -= (1 * monsterSpeed)
			}
		}
	}

// KEEP THIS AT THE BOTTOM
	function draw(){
		update();
		monsterMove();
		// put out bgimage on the context at x=o and y = 0
		context.drawImage(backgroundImage,0,0);
		context.drawImage(hero, heroLocation.x, heroLocation.y);
		context.drawImage(monster, monsterLocation.x, monsterLocation.y);
		requestAnimationFrame(draw);
	}

draw();

</script>

</body>
</html>